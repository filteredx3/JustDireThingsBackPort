# Just Dire Things – Minecraft 1.12.2 Backport Plan

Target runtime:
- Minecraft **1.12.2**
- Forge **14.23.5.2860**
- Java **Temurin JRE 8u482**

This plan is designed to be executed in phases so the project remains buildable and testable while major systems are rewritten.

---

## 0) Current-state assessment (completed in this change)

- [x] Measured source/API surface and documented high-risk deltas in `compatibility-inventory.md`.
- [x] Added a repeatable analysis script to refresh that inventory after each migration batch.
- [x] Established a dedicated `backport-1.12.2/` workspace scaffold for Forge 1.12.2 build settings.

Exit criteria:
- A baseline migration risk report exists and can be regenerated at any time.

---

## 1) Build and runtime bootstrap

### Goals
- Stand up a separate Forge 1.12.2 build that can compile a minimal mod entrypoint under Java 8.
- Keep modern branch sources intact while introducing a backport workspace to avoid blocking current development.

### Tasks
1. Create isolated backport Gradle project (`backport-1.12.2`).
2. Pin ForgeGradle version and mappings compatible with 1.12.2.
3. Enforce Java 8 (`sourceCompatibility`/`targetCompatibility`).
4. Add a minimal `@Mod` class and `mcmod.info` for smoke tests.
5. Validate with `gradlew tasks` and `gradlew build` in the backport workspace.

### Risks
- Modern gradle plugins and DSL from NeoForge are not portable to ForgeGradle 1.12.2.

Exit criteria:
- Backport workspace builds a dev jar with no runtime classes migrated yet.

---

## 2) Architectural split and migration strategy

### Goals
- Decide how much functionality is retained for 1.12.2 vs intentionally deferred.

### Tasks
1. Feature-tier matrix:
   - **Tier A**: Must-have content (core blocks, tools, basic machines).
   - **Tier B**: Advanced systems (portal/time/paradox systems).
   - **Tier C**: Optional/disable-on-backport features.
2. Introduce `common-logic` extraction where possible for pure Java utilities.
3. Document unsupported features due to engine limitations.

Exit criteria:
- Signed-off feature matrix and a clear definition of done for the first 1.12.2 release.

---

## 3) Registration and lifecycle rewrite

### Goals
- Convert modern DeferredRegister/event bootstrap to 1.12 registry/lifecycle conventions.

### Tasks
1. Replace DeferredRegister-based registries with 1.12 registry event handlers.
2. Introduce sided proxies (`CommonProxy`/`ClientProxy`) where needed.
3. Move init calls into `preInit/init/postInit` as required by legacy Forge patterns.
4. Rework creative tabs, item/block registration, and TileEntity registrations.

Exit criteria:
- Core items/blocks/entities register and load without missing registry errors.

---

## 4) Data model migration (Data Components → NBT + Capabilities)

### Goals
- Replace modern item data components with 1.12-compatible storage patterns.

### Tasks
1. Create NBT helper API for item state and upgrade data.
2. Rewrite tool/ability state from data components to NBT compounds/lists.
3. Re-implement inventories/fluids/energy state with 1.12 capabilities.
4. Add migration adapters to read old save keys when possible.

Exit criteria:
- Tool state persists and syncs correctly in SP/MP on 1.12.2.

---

## 5) Networking rewrite

### Goals
- Replace modern payload/codec networking with SimpleNetworkWrapper.

### Tasks
1. Define packet IDs and side handlers.
2. Port all client keybind/tool-toggle/config GUIs packet flows.
3. Add robust serialization/deserialization tests where possible.
4. Verify thread-safe scheduling via `IThreadListener`.

Exit criteria:
- No gameplay feature depends on modern payload APIs.

---

## 6) BlockEntities, capabilities, and machine logic

### Goals
- Port machine internals to 1.12 TileEntities and capability access patterns.

### Tasks
1. Convert BlockEntity classes to `TileEntity` + `ITickable` (as needed).
2. Port inventory/fluid/energy handlers to 1.12 implementations.
3. Rewrite capability exposure (`hasCapability/getCapability`) for blocks/items.
4. Confirm chunk-loading related systems using ForgeChunkManager equivalents.

Exit criteria:
- Tier A machines tick, persist, and interact with pipes/hoppers/automation.

---

## 7) Rendering and client systems

### Goals
- Re-implement or simplify rendering features for the 1.12 render pipeline.

### Tasks
1. Port model registrations and baked model hooks.
2. Replace modern render layers/vertex consumers with 1.12 rendering APIs.
3. Rebuild HUD overlays and keybind handling for 1.12 event bus.
4. Validate particles and entity renderers one-by-one.

Exit criteria:
- Client loads with no missing model/render crashes for Tier A content.

---

## 8) Data/content asset backport

### Goals
- Convert data-pack-driven assets to 1.12 formats and registration systems.

### Tasks
1. Recipes: JSON schemas compatible with 1.12 recipe loading.
2. Loot tables: backport schema and entry conditions.
3. Remove/replace tags, modern loaders, and unsupported conditions.
4. Replace generated-data assumptions with static assets where needed.

Exit criteria:
- Recipes/loot load cleanly on dedicated server and client.

---

## 9) Integration dependencies

### Goals
- Keep optional integrations stable in 1.12 ecosystem.

### Tasks
1. Map each dependency to a 1.12-compatible version.
2. Guard optional integrations with `Loader.isModLoaded` checks.
3. Rework API hooks for JEI/Patchouli/other mods according to 1.12 APIs.

Exit criteria:
- No hard crash when optional dependency mods are missing.

---

## 10) QA, performance, and release

### Goals
- Produce a playable/stable 1.12.2 build.

### Tasks
1. Regression checklist for every Tier A feature.
2. Multiplayer smoke test (dedicated server + client).
3. Save/load and chunk-unload persistence tests.
4. Final artifact naming and distribution metadata.
5. Publish migration notes and known limitations.

Exit criteria:
- Tagged 1.12.2-compatible release candidate with reproducible build instructions.

---

## Immediate next actions (recommended after this commit)

1. Implement Phase 1 step 4: add a minimal 1.12.2 `@Mod` bootstrap class and `mcmod.info` in backport workspace.
2. Start Phase 3 with Tier A registry rewrite (blocks/items only).
3. Start Phase 4 by migrating one representative tool (NBT-based state) end-to-end.

